{{- $id := printf "echart-%s" (partial "functions/uid.html" .) -}}
<div id="{{ $id }}" style="width: 100%; height: 500px;"></div>

<script type="module">
	const chartDom = document.getElementById('{{ $id }}');
	if (chartDom) {
		let myChart = echarts.init(chartDom);
		let option;

		{{ .Inner | safeJS }}

		myChart.setOption(option);

		window.addEventListener('resize', () => myChart?.resize());

		window.addEventListener('appearance-changed', (e) => {
			const theme = e.detail.appearance;
			myChart.dispose();
			myChart = echarts.init(chartDom, theme);
			myChart.setOption(option);
		});
	}
</script>
